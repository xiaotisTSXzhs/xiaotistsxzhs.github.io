08.26 05:37
index
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>光遇 81 点地图</title>
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif}
#map{width:100%;height:100%;background:#000 no-repeat center/cover;transition:background .4s}
#info{
  position:fixed;
  bottom:0;left:0;right:0;
  background:transparent;   /* ← 完全透明 */
  color:#fff;
  max-height:60%;
  padding:12px 16px;
  transform:translateY(100%);
  transition:transform .3s;
  overflow-y:auto}
#info.show{transform:translateY(0)}
#info h2{margin-bottom:6px}
#info ul{list-style:none}
#info li{margin:4px 0}
#back{position:fixed;top:12px;left:12px;background:rgba(0,0,0,.5);color:#fff;border:none;padding:6px 10px;border-radius:6px;font-size:14px}
</style>
</head>
<body>
<div id="map"></div>
<button id="back">↩ 后退</button>
<div id="info">
  <h2 id="info-title"></h2>
  <p id="info-stats"></p>
  <ul id="info-list"></ul>
</div>
<script>
const points = [
  {"id":1,"name":"遇境","wing":0,"shrine":1,"ancestor":0},
  {"id":2,"name":"云巢","wing":0,"shrine":1,"ancestor":0},
  {"id":3,"name":"服装商店","wing":0,"shrine":0,"ancestor":0},
  {"id":4,"name":"魔法商店","wing":0,"shrine":0,"ancestor":0},
  {"id":5,"name":"家具商店","wing":0,"shrine":0,"ancestor":0},
  {"id":6,"name":"公寓","wing":0,"shrine":0,"ancestor":0},
  {"id":7,"name":"晨岛","wing":5,"shrine":4,"ancestor":7},
  {"id":8,"name":"夜行石","wing":0,"shrine":0,"ancestor":4},
  {"id":9,"name":"预言山谷","wing":0,"shrine":1,"ancestor":0},
  {"id":10,"name":"湖水的试炼","wing":1,"shrine":1,"ancestor":0},
  {"id":11,"name":"土地的试炼","wing":1,"shrine":1,"ancestor":0},
  {"id":12,"name":"空气的试炼","wing":1,"shrine":1,"ancestor":0},
  {"id":13,"name":"火焰的试炼","wing":1,"shrine":1,"ancestor":0},
  {"id":14,"name":"晨岛神殿","wing":1,"shrine":0,"ancestor":0},
  {"id":15,"name":"云野大厅","wing":1,"shrine":1,"ancestor":0},
  {"id":16,"name":"蝴蝶平原","wing":2,"shrine":1,"ancestor":2},
  {"id":17,"name":"幽光山洞","wing":2,"shrine":1,"ancestor":2},
  {"id":18,"name":"云峰","wing":3,"shrine":1,"ancestor":4},
  {"id":19,"name":"仙乡","wing":3,"shrine":1,"ancestor":4},
  {"id":20,"name":"锦鲤池","wing":2,"shrine":1,"ancestor":0},
  {"id":21,"name":"云顶浮石","wing":2,"shrine":1,"ancestor":3},
  {"id":22,"name":"中央神坛","wing":1,"shrine":1,"ancestor":1},
  {"id":23,"name":"圣岛","wing":8,"shrine":1,"ancestor":6},
  {"id":24,"name":"云野神殿","wing":0,"shrine":0,"ancestor":0},
  {"id":25,"name":"雨林大厅","wing":0,"shrine":1,"ancestor":0},
  {"id":26,"name":"风行网道","wing":1,"shrine":1,"ancestor":4},
  {"id":27,"name":"静谧庭院","wing":2,"shrine":1,"ancestor":3},
  {"id":28,"name":"荧光森林","wing":4,"shrine":1,"ancestor":7},
  {"id":29,"name":"密林遗迹","wing":3,"shrine":1,"ancestor":7},
  {"id":30,"name":"大树屋","wing":2,"shrine":1,"ancestor":0},
  {"id":31,"name":"秘密花园","wing":2,"shrine":1,"ancestor":0},
  {"id":32,"name":"青鸟剧场","wing":1,"shrine":1,"ancestor":0},
  {"id":33,"name":"地下溶洞","wing":4,"shrine":1,"ancestor":1},
  {"id":34,"name":"雨林神殿","wing":0,"shrine":1,"ancestor":0},
  {"id":35,"name":"后花园","wing":1,"shrine":1,"ancestor":0}
];
const points2 = [
  {"id":36,"name":"霞谷大厅","wing":1,"shrine":1,"ancestor":0},
  {"id":37,"name":"溜冰场","wing":2,"shrine":1,"ancestor":4},
  {"id":38,"name":"霞光城","wing":2,"shrine":1,"ancestor":3},
  {"id":39,"name":"飞行赛道","wing":2,"shrine":1,"ancestor":0},
  {"id":40,"name":"滑雪赛道","wing":1,"shrine":1,"ancestor":0},
  {"id":41,"name":"落日竞技场","wing":2,"shrine":1,"ancestor":3},
  {"id":42,"name":"圆梦村","wing":3,"shrine":2,"ancestor":4},
  {"id":43,"name":"圆梦村剧场","wing":1,"shrine":1,"ancestor":4},
  {"id":44,"name":"音乐大厅","wing":0,"shrine":0,"ancestor":0},
  {"id":45,"name":"雪隐峰","wing":2,"shrine":1,"ancestor":0},
  {"id":46,"name":"霞谷神殿","wing":1,"shrine":1,"ancestor":1},
  {"id":47,"name":"墓土大厅","wing":0,"shrine":1,"ancestor":0},
  {"id":48,"name":"藏宝岛礁","wing":2,"shrine":1,"ancestor":4},
  {"id":49,"name":"边陲荒漠","wing":2,"shrine":1,"ancestor":2},
  {"id":50,"name":"巨兽荒原","wing":6,"shrine":1,"ancestor":5},
  {"id":51,"name":"黑水港湾","wing":3,"shrine":1,"ancestor":2},
  {"id":52,"name":"远古战场","wing":2,"shrine":1,"ancestor":1},
  {"id":53,"name":"失落方舟","wing":2,"shrine":1,"ancestor":6},
  {"id":54,"name":"墓土神殿","wing":1,"shrine":1,"ancestor":0},
  {"id":55,"name":"禁阁一层","wing":1,"shrine":1,"ancestor":2},
  {"id":56,"name":"禁阁二层","wing":0,"shrine":0,"ancestor":1},
  {"id":57,"name":"禁阁三层","wing":1,"shrine":1,"ancestor":1},
  {"id":58,"name":"禁阁四层","wing":2,"shrine":1,"ancestor":4},
  {"id":59,"name":"禁阁五层","wing":1,"shrine":0,"ancestor":0},
  {"id":60,"name":"禁阁六层","wing":1,"shrine":1,"ancestor":0},
  {"id":61,"name":"禁阁顶层","wing":0,"shrine":0,"ancestor":0},
  {"id":62,"name":"档案阁","wing":2,"shrine":1,"ancestor":1},
  {"id":63,"name":"庇护所","wing":1,"shrine":1,"ancestor":4},
  {"id":64,"name":"伊甸（第一阶段）","wing":1,"shrine":1,"ancestor":0},
  {"id":65,"name":"伊甸（第二阶段）","wing":9,"shrine":1,"ancestor":0},
  {"id":66,"name":"暴风眼","wing":0,"shrine":1,"ancestor":0},
  {"id":67,"name":"重生之路（第一阶段）","wing":0,"shrine":0,"ancestor":0},
  {"id":68,"name":"重生之路（第二阶段）","wing":0,"shrine":0,"ancestor":0},
  {"id":69,"name":"重生之路（第三阶段）","wing":0,"shrine":1,"ancestor":0},
  {"id":70,"name":"藏星阁","wing":0,"shrine":1,"ancestor":0},
  {"id":71,"name":"月牙绿洲","wing":3,"shrine":1,"ancestor":4},
  {"id":72,"name":"星光沙漠","wing":3,"shrine":1,"ancestor":0},
  {"id":73,"name":"姆明故事书","wing":1,"shrine":1,"ancestor":0},
  {"id":74,"name":"姆明谷的森林","wing":0,"shrine":0,"ancestor":0},
  {"id":75,"name":"内心世界","wing":0,"shrine":0,"ancestor":0},
  {"id":76,"name":"群星影院","wing":0,"shrine":1,"ancestor":0},
  {"id":77,"name":"市集","wing":0,"shrine":0,"ancestor":0},
  {"id":78,"name":"秘密基地（办公室）","wing":0,"shrine":1,"ancestor":0},
  {"id":79,"name":"秘密基地（任天堂）","wing":0,"shrine":0,"ancestor":0},
  {"id":80,"name":"冥想之地","wing":0,"shrine":0,"ancestor":0},
  {"id":81,"name":"咖啡店","wing":0,"shrine":0,"ancestor":0}
];
const routes = [
  [1,[7,15,25,36,47,55,64]],
  [2,[3,4,5,6,70,80,81,7,15,25,36,47,55,64]],
  [3,[2]], [4,[2]], [5,[2]], [6,[2]],
  [7,[8,9,14]],
  [8,[7]],
  [9,[10,11,12,13,14,7,26]],
  [10,[9]], [11,[9]], [12,[9]], [13,[9]],
  [14,[7,15]],
  [15,[16]],
  [16,[17,19,21,15]],
  [17,[16,18,19]],
  [18,[17]],
  [19,[17,16,20,21,22]],
  [20,[24,19]],
  [21,[16,19,23]],
  [22,[20]],
  [23,[21,26]],
  [24,[20,25]],
  [25,[26,27]],
  [26,[25,33,45,53,72,9,23]],
  [27,[25,30,28]],
  [28,[27,30,31,29]],
  [29,[28,30,34]],
  [30,[27,28,29]],
  [31,[28,32,29,33]],
  [32,[]],
  [33,[31,26]],
  [34,[29,35]],
  [35,[34,36]],
  [36,[37,42]],
  [37,[38,40]],
  [38,[37,39]],
  [39,[38,41]],
  [40,[37,41]],
  [41,[42,46]],
  [42,[36,43,44,45,41]],
  [43,[44,42]],
  [44,[42,43]],
  [45,[42,26]],
  [46,[41,47]],
  [47,[46,79,48,49]],
  [48,[47]],
  [49,[50,53]],
  [50,[49,51,52]],
  [51,[50,52]],
  [52,[50,51,54]],
  [53,[49,26]],
  [54,[52,55]],
  [55,[78,70,62,63,56]],
  [56,[57]],
  [57,[58]],
  [58,[59]],
  [59,[60]],
  [60,[61]],
  [61,[64]],
  [62,[55]],
  [63,[55]],
  [64,[65]],
  [65,[64,66]],
  [66,[67]],
  [67,[68]],
  [68,[69]],
  [69,[1]],
  [70,[71,72,73,41,76,2]],
  [71,[]],
  [72,[26]],
  [73,[74,75]],
  [74,[]],
  [75,[]],
  [76,[77,70]],
  [77,[]],
  [78,[55]],
  [79,[7,15,25,36,47,55,64]],
  [80,[2]],
  [81,[2]]
];
/* 合并 points */
points.push(...points2);
/* 构建邻接表：仅单向，不自动补双向 */
const adj = {};
points.forEach(p => adj[p.id] = new Set());
routes.forEach(([from, list]) => list.forEach(to => adj[from].add(to)));
/* 全局单向回程：所有点 → 01、02 */
points.forEach(p => { adj[p.id].add(1); adj[p.id].add(2); });
/* ====== 运行逻辑 ====== */
let current = 1;
const historyStack = [current];
function loadPoint(id) {
  current = id;
  const p = points.find(p => p.id === id);
  document.getElementById('map').style.backgroundImage = `url(img/${String(id).padStart(2,'0')}.jpg)`;
  document.getElementById('info-title').textContent = p.name;
  document.getElementById('info-stats').textContent = `光翼: ${p.wing} | 神龛: ${p.shrine} | 先祖: ${p.ancestor}`;
  const list = document.getElementById('info-list');
  list.innerHTML = '';
  Array.from(adj[id]).sort((a,b)=>a-b).forEach(next => {
    const li = document.createElement('li');
    const target = points.find(p => p.id === next);
    li.innerHTML = `<button onclick="go(${next})">${target.name}</button>`;
    list.appendChild(li);
  });
  document.getElementById('info').classList.add('show');
}
function go(id) {
  historyStack.push(current);
  loadPoint(id);
}
document.getElementById('back').addEventListener('click', () => {
  if (historyStack.length > 1) {
    historyStack.pop();
    loadPoint(historyStack[historyStack.length-1]);
  }
});
loadPoint(current);
</script>
</body>
</html>

